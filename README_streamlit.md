# 📧 이메일 분류 시스템 - Streamlit 웹앱

이 프로젝트는 **Google 계정 로그인**과 Gmail API 연동이 통합된 이메일 분류 웹 애플리케이션입니다.

## 🚀 주요 기능

- **🔐 Google 계정 로그인**: Gmail OAuth를 통한 간편한 로그인
- **📧 Gmail API 연동**: 실제 Gmail 계정에서 이메일 가져오기
- **📊 이메일 목록 관리**: 이메일 검색, 필터링, 수동 분류
- **🤖 이메일 분류**: Work, Personal, Advertisement 카테고리 분류
- **📈 분석 대시보드**: 이메일 분류 통계 및 시각화
- **⚙️ 설정 관리**: 사용자 정보 및 데이터 관리

## 🔄 통합된 로그인 시스템

이전의 별개 로그인 시스템에서 **Google 계정으로 통합**되었습니다:

### 이전 (별개 시스템)
```
1. 웹앱 로그인 → 2. Gmail 연동 → 3. 이메일 가져오기
```

### 현재 (통합 시스템)
```
1. Google 계정 로그인 → 2. 자동 Gmail 연동 → 3. 이메일 가져오기
```

**장점:**
- ✅ 한 번의 로그인으로 모든 기능 사용
- ✅ 별도의 Gmail 연동 과정 불필요
- ✅ Google 프로필 정보 자동 동기화
- ✅ 보안성 향상 (OAuth 2.0)

## 📋 설치 및 실행

### 1. 필요한 라이브러리 설치

```bash
pip install -r requirements_streamlit.txt
```

### 2. Gmail API 설정

#### 2.1 Google Cloud Console에서 프로젝트 생성

1. [Google Cloud Console](https://console.cloud.google.com/)에 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택
3. 프로젝트 이름을 입력하고 생성

#### 2.2 API 활성화

1. 왼쪽 메뉴에서 "API 및 서비스" > "라이브러리" 선택
2. 다음 API들을 활성화:
   - **Gmail API** (이메일 접근용)
   - **People API** (사용자 프로필 정보용)

#### 2.3 OAuth 2.0 클라이언트 ID 생성

1. "API 및 서비스" > "사용자 인증 정보" 선택
2. "사용자 인증 정보 만들기" > "OAuth 클라이언트 ID" 선택
3. 애플리케이션 유형: "데스크톱 앱" 선택
4. 이름 입력 후 "만들기" 클릭
5. 생성된 클라이언트 ID와 클라이언트 보안 비밀번호 확인

#### 2.4 credentials.json 파일 다운로드

1. 생성된 OAuth 2.0 클라이언트 ID 옆의 다운로드 버튼 클릭
2. 다운로드된 JSON 파일을 프로젝트 루트 디렉토리에 `credentials.json`으로 저장

### 3. 애플리케이션 실행

```bash
streamlit run app.py
```

브라우저에서 `http://localhost:8501`로 접속하여 애플리케이션을 사용할 수 있습니다.

## 🎯 사용 방법

### 1. Google 계정 로그인

1. 애플리케이션에 접속
2. "🔗 Google 계정으로 로그인" 버튼 클릭
3. 브라우저에서 Google 계정 선택 및 권한 허용
4. 자동으로 Gmail API 연동 완료

### 2. 이메일 관리

1. "📧 이메일 목록" 탭에서 이메일 조회
2. 검색 조건 설정 (보낸 사람, 날짜 등)
3. 이메일 유형 선택 (전체, 읽지 않은 이메일, 최근 이메일)
4. "🔍 이메일 검색" 버튼으로 이메일 가져오기
5. 각 이메일에 대해 분류 버튼 클릭 (Work, Personal, Advertisement)

### 3. 이메일 분류 및 분석

1. "🤖 이메일 분류" 탭에서 분류 기록 확인
2. "📈 분석" 탭에서 이메일 분류 통계 확인
3. 일별 이메일 분류 추이 차트
4. 이메일 유형별 분포 파이 차트
5. 통계 요약 정보

### 4. 설정 및 데이터 관리

1. "⚙️ 설정" 탭에서 사용자 정보 확인
2. 분류 데이터 CSV 내보내기
3. 분류 데이터 초기화 (필요시)

## 📁 파일 구조

```
email_classifier/
├── app.py                    # 메인 Streamlit 애플리케이션
├── auth_system.py           # 통합된 인증 시스템 (Google OAuth)
├── gmail_api.py             # Gmail API 연동
├── requirements_streamlit.txt # 필요한 라이브러리
├── README_streamlit.md      # 사용법 안내서
├── credentials.json         # Gmail API 설정 파일 (사용자가 생성)
├── token.json              # Gmail 인증 토큰 (자동 생성)
└── users.db                # 사용자 데이터베이스 (자동 생성)
```

## 🔧 주요 컴포넌트

### AuthSystem 클래스 (통합된 인증)
- **Google OAuth 인증**: Gmail API를 통한 사용자 인증
- **자동 사용자 등록**: 첫 로그인시 자동 계정 생성
- **프로필 정보 동기화**: Google People API로 이름, 프로필 사진 가져오기
- **이메일 분류 데이터 관리**: 사용자별 분류 기록 저장

### GmailAPI 클래스
- **Gmail API 인증 및 토큰 관리**
- **이메일 목록 조회 및 검색**
- **이메일 상세 정보 추출**
- **이메일 통계 수집**

### Streamlit 앱 구조
- **로그인 페이지**: Google 계정 로그인
- **메인 대시보드**: 4개 탭으로 구성
  - 이메일 목록
  - 이메일 분류
  - 분석
  - 설정

## 🛠️ 개발 환경

- **Python**: 3.8+
- **Streamlit**: 1.28.1
- **Google API Python Client**: 2.108.0
- **SQLite**: 내장 데이터베이스
- **Plotly**: 데이터 시각화

## 🔒 보안 고려사항

- **OAuth 2.0 인증**: Google의 안전한 인증 시스템 사용
- **토큰 관리**: 자동 토큰 갱신 및 안전한 저장
- **데이터 분리**: 사용자별 데이터 격리
- **API 권한 제한**: 읽기 전용 권한만 사용

## 🚨 주의사항

1. **credentials.json 파일 보안**: 이 파일은 민감한 정보를 포함하므로 안전하게 보관
2. **Gmail API 할당량**: Gmail API는 일일 사용량 제한이 있음
3. **토큰 만료**: OAuth 토큰은 만료될 수 있으므로 필요시 재인증 필요
4. **People API 권한**: 사용자 프로필 정보 접근 권한 필요

## 🔄 향후 개선 사항

- [ ] **AI 모델 통합**: 기존 BERT 모델과 연동하여 자동 분류
- [ ] **실시간 이메일 알림**: 새 이메일 도착시 알림
- [ ] **고급 검색 필터**: 더 정교한 이메일 검색 기능
- [ ] **자동 분류 정확도 향상**: 사용자 피드백을 통한 모델 개선
- [ ] **다중 사용자 지원**: 팀 단위 사용 지원
- [ ] **데이터 백업**: 클라우드 백업 기능
- [ ] **API 엔드포인트**: REST API 제공

## 📞 지원

문제가 발생하거나 질문이 있으시면 이슈를 생성해주세요.

---

**참고**: 이 애플리케이션은 교육 및 개발 목적으로 제작되었습니다. 실제 프로덕션 환경에서 사용하기 전에 보안 검토를 권장합니다. 